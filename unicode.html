<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<title>unicode</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>

<div id="Unicode ä¸ UTF-8"><h1 id="Unicode ä¸ UTF-8" class="header"><a href="#Unicode ä¸ UTF-8">Unicode ä¸ UTF-8</a></h1></div>

<p>
Unicode æ˜¯æŠ½è±¡çš„æ•°å­—ç¼–ç ï¼ŒUTF-8 æ˜¯å…·ä½“çš„å­—èŠ‚ç¼–ç ã€‚
</p>

<ul>
<li>
<a href="https://zh.wikipedia.org/wiki/Unicode">https://zh.wikipedia.org/wiki/Unicode</a>

<li>
<a href="https://zh.wikipedia.org/wiki/UTF-8">https://zh.wikipedia.org/wiki/UTF-8</a>

<li>
<a href="https://unicode-table.com/">https://unicode-table.com/</a>

</ul>

<div id="Unicode ä¸ UTF-8-emoji ä¾‹å­ ğŸ˜‹"><h3 id="emoji ä¾‹å­ ğŸ˜‹" class="header"><a href="#Unicode ä¸ UTF-8-emoji ä¾‹å­ ğŸ˜‹">emoji ä¾‹å­ ğŸ˜‹</a></h3></div>

<p>
Python:
</p>

<pre py>
&gt;&gt;&gt; s = 'ğŸ˜‹'
&gt;&gt;&gt; s.encode()
b'\xf0\x9f\x98\x8b'
&gt;&gt;&gt; import json
&gt;&gt;&gt; json.dumps(s)
'"\\ud83d\\ude0b"'
&gt;&gt;&gt; ord(s)
128523
&gt;&gt;&gt; len(s)
1
</pre>

<p>
ä¸€ä¸ªå­—ç¬¦ï¼Œåœ¨å†…å­˜ä¸­ï¼Œæ™®é€š ascii å­—ç¬¦å ç”¨ 1 å­—èŠ‚ï¼Œæ™®é€šæ±‰å­—å ç”¨ 2 å­—èŠ‚ï¼Œemoji å­—ç¬¦å ç”¨ 4 å­—èŠ‚ï¼Œè™½ç„¶ä»–ä»¬éƒ½æ˜¯é•¿åº¦ 1ã€‚
</p>

<p>
ä¸€ä¸ªå­—ç¬¦ä¸²åŒ…å«å¤šç§å­—ç¬¦æ—¶ï¼Œå ç”¨å†…å­˜ä¸º æœ€å å†…å­˜çš„å­—ç¬¦ x é•¿åº¦ï¼Œ<code>"s" * 1024</code> å  1K å†…å­˜ï¼Œ<code>"s" * 1023 + "ğŸ˜‹"</code> å  4k å†…å­˜ã€‚
</p>


<p>
JavaScript:
</p>

<pre js>
&gt; const s = 'ğŸ˜‹'
&gt; s.length
2
&gt; (s + 'x').length
3
&gt; (s + 'ä¸­').length
3
&gt; new TextEncoder().encode(s)
Uint8Array [ 240, 159, 152, 139 ]
&gt; new TextEncoder().encode('ä¸­')
Uint8Array [ 228, 184, 173 ]

&gt; const n = 1024*1024*100
&gt; const ss = 'ğŸ˜‹'.repeat(n)
&gt; ss.indexOf('x')  // active this string
-1
// memory usage 400M

&gt; const ss = 'ä¸­'.repeat(n); ss.indexOf('x')
// memory usage 200M

&gt; const ss = 's'.repeat(n); ss.indexOf('x')
// memory usage 100M

&gt; const ss = 's'.repeat(n) + 'ä¸­'.repeat(n); ss.indexOf('x')
// memory usage 400M, is 200M + 200M, not 100M + 200M

&gt; const ss = 's'.repeat(n) + 'ğŸ˜‹'.repeat(n);; ss.indexOf('x')
// memory usage 600M, is 200M + 2 * 200M
</pre>

<p>
JavaScript çš„å†…å­˜ä½¿ç”¨æƒ…å†µä¸ Python ç±»ä¼¼ï¼Œæœ‰å¯¹æ™®é€šçº¯ ascii å­—ç¬¦ä¸²åšä¼˜åŒ–ã€‚
<code>emoji.length == 2</code>ï¼Œå› ä¸ºå­—ç¬¦åœ¨å†…å­˜ä¸­ä½¿ç”¨ UTF-16 ç¼–ç å­˜æ”¾ï¼Œ<code>.length</code> è¿”å›çš„æ˜¯ UTF-16 çš„å•å…ƒæ•°é‡ã€‚emoji è¢«è®¤ä¸ºæ˜¯ 2 å•å…ƒå  4 å­—èŠ‚å†…å­˜ã€‚
</p>

</body>
</html>
